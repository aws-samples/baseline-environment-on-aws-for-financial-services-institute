# FISCSEC1: アクセス許可をどのように設定・管理していますか？

不正アクセス等から重要なデータを保護するため、必要最低限のアクセス許可設定が必要になります。また、アクセス権限については人事異動などに伴い速やかに変更されることが求められており、アクセス権限の見直し手続きを明確にする必要があります。

## FISCSEC1-BP01 不正アクセス等から重要なファイルを保護するため、重要なファイルについてはアクセス制御を適切に設定します。

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 5

### 解説

- AWS リソースへのアクセス権限について、付与されている権限のうち、利用されていない権限について AWS Identity and Access Management (IAM) アクセスアドバイザーで最終アクセス時間を確認することで検出することが可能になります。アクセス権限の妥当性について確認を行い、不要であれば削除します。
- インバウンドトラフィックとアウトバウンドトラフィックの両方について、多層防御アプローチでコントロールを適用します。たとえば、Amazon Virtual Private Cloud (VPC) の場合、これにはセキュリティグループ、ネットワーク ACL、サブネット、AWS Network Firewall が含まれます。
- 重要なファイルへのアクセスについて、VPC からのみアクセスを許可することで、ネットワークレイヤでの対策を追加することが可能になります。例えば Amazon S3 に保存する場合、VPC エンドポイントやパブリックブロックアクセスを活用することで実現することが可能です。

## FISCSEC1-BP02 渉外端末等、決まった拠点以外での操作が可能になる端末かどうかを識別し、権限の範囲を明確にする必要があります。

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 61

### 解説

- AWS リソースへのアクセス権限について、外部エンティティと共有されている Amazon S3 バケットや IAM ロールなど、重要なリソースについて意図しないアクセスが許可されていないか、AWS IAM Access Analyzer を確認することで検出することが可能になります。アクセス権限の妥当性について確認を行い、不要であれば削除します。

## FISCSEC1-BP03 個人データ等を扱うシステムについては、アクセス権限の付与、削除等のオペレーションが明確である必要があります。

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 27

### 解説

- AWS リソースへのアクセス権限付与について、アクセス権限の申請者と承認者で相互牽制が働く構造とすることが推奨されます。IAM エンティティのアクセス許可境界 を利用することで、アイデンティティベースのポリシーが IAM エンティティに付与できるアクセス許可の上限を設定することが可能です。エンティティのアクセス許可の境界により、エンティティは、アイデンティティベースのポリシーとそのアクセス許可の境界の両方で許可されているアクションのみを実行できます。また、特権の昇格を防ぐために、サービスコントロールポリシー (SCP) を利用してアカウント内のユーザー (IAM 管理者または委任された管理者を除く) が管理 IAM アクションを使用できないよう制御することも可能です。
- アクセス権限は一定期間での見直しが求められますが、それ以外にも、所属や組織の変更に伴う人事異動時、入社や退職、休職、長期の出張、システムの追加やリタイア等のタイミングでも見直しを行うことが必要となります。アクセス権限の見直しは、人に属する権限に限定せず、サーバーリソースに付与されている権限についても見直しが必要です。アクセス権限の管理・変更は、クラウド利用者側でのワークフロー対応の他、AWS Identity and Access Management (IAM) アクセスアドバイザーによる不要なアクセス権限付与の確認や、AWS IAM Access Analyzer による意図しないアクセス許可の確認が有効です。

### 関連情報

- [IAM アクセスアドバイザー API と AWS CLI を用いてサービスのアクセス時間を確認する](https://aws.amazon.com/jp/blogs/security/automate-analyzing-permissions-using-iam-access-advisor/)
- [Amazon Quicksight を利用して IAM Access Analyzer の検証結果を視覚化する](https://aws.amazon.com/jp/blogs/security/how-to-visualize-iam-access-analyzer-policy-validation-findings-with-quicksight/)

# FISCSEC2: システムの操作記録検証のためにどのような情報を収集していますか？

## FISCSEC2-BP01 AWS アカウントのアクティビティを監視します。

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 63、実 10

### 解説

- 各アカウントで AWS CloudTrail をオンにして、サポートされている各リージョンで使用します。CloudTrail はデフォルトではコントロールプレーンに対する API コールを記録することができます。データイベントの記録を有効化することで、データプレーンに対する API コールも記録することができます。
- アクセスが非常に制限されている一元化されたログアカウントに AWS CloudTrail ログを保存します。CloudTrail ログファイルの整合性の検証を使用することでログファイル自体が変更されていないこと、または特定のユーザーの認証情報が特定の API アクティビティを実行したことを確実に検証することができます。CloudTrail ログファイルの整合性の検証プロセスでは、ログファイルが削除または変更されたかどうかを知ることもできます。また、指定された期間内にログファイルがアカウントに配信されていないことを確実に検証することが可能です。
- CloudTrail ログファイルを定期的に調べます。また、AWS CloudTrail イベント、VPC フローログ、DNS ログを継続的に分析することで脅威を検出するサービスである GuardDuty を使用することもできます。AWS Security Incident Response を活用することで GuarDuty の検出結果をトリアージし、インシデント対応を強化することもできます。CloudTrail で取得したログを S3 へと保管し、イベントを CloudWatch へと送信することができます。監視したいイベントの定義と閾値を設定することで、CloudWatch Alarm により管理者へと自動通知を行うことが可能です。
- Amazon S3 のサーバーアクセスログは、各バケットに対して行われたリクエストをベストエフォートで記録します。バケットに対するリクエストの傾向を把握することができます。
- アカウントが不正に使用されたと考えられる場合は、発行された一時的な認証情報に注意してください。認識できない一時的な認証情報が発行された場合は、それらのアクセス許可を無効にします。
- サービスの最終アクセス時間データを使用して、IAM ロールを定期的に確認します。IAM エンティティ (ユーザーまたはロール) が最後にサービスにアクセスを試みたときのレポートを表示できます。次に、その情報を使用してポリシーを調整し、使用中のサービスのみへのアクセスを許可することができます。IAM のリソースの種類ごとにレポートを生成できます。詳細については、サービスの最終アクセス時間データの表示プロセスのドキュメントをお読みください。
- OS 以上のレイヤーなどお客様責任範囲部分での操作ログの取得については、3rd Party 製品を活用いただくことで実現できます。

## FISCSEC2-BP02 AWS アカウントのアクティビティと実際の利用者の関連付けについて、検証を可能にします。管理者、開発者、オペレーター、エンドユーザーは、AWS 環境とアプリケーションにアクセスするために ID を必要とします。これらの者は、あなたの組織のメンバー、または共同作業を行う外部ユーザーで、ウェブブラウザ、クライアントアプリケーション、またはインタラクティブなコマンドラインツールを介して AWS リソースを操作する人たちです。AWS リソースの操作を実行したユーザーと実際の利用者について関連付けを可能にし、誰がその操作を実行したのかを検証可能にしておくことが求められます。

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 63

### 解説

- 一元化された場所で ID を管理できる ID プロバイダーを利用します。これにより、1 つの場所からアクセスを作成、管理、取り消すことができるため、アクセスの管理が容易になります。これにより、複数の認証情報の要件が軽減され、HR プロセスと統合する機会がもたらされます。HR プロセスとの統合は、操作を実行したユーザー ID と実際の操作者本人との関連付けを容易にし、操作実行者の検証を効果的に行うことが可能となります。
- ユーザーグループと属性を活用します。一般的なセキュリティ要件を持つユーザーを ID プロバイダーによって定義されたグループに配置し、アクセスコントロールに使用される可能性のあるユーザー属性 (部署や場所など) が正確で、最新の状態に保たれるようにするメカニズムを導入します。アクセスを制御するには、個々のユーザーではなくこれらのグループと属性を使用します。これにより、ユーザーのアクセスニーズが変化したときに多くの個別のポリシーを更新することなく、ユーザーのグループメンバーシップや属性を 1 回変更することで、アクセスを一元管理できます。

## FISCSEC2-BP03 使用しているサービスのタイムゾーンを確認しシステム間の時刻のずれがないよう留意する

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 10

### 解説

- すべての Amazon RDS DB インスタンスは、デフォルトで UTC/GMT 時間を使用します。タイムゾーンの変更は任意です。データベースレイヤーでは UTC タイムゾーンを使用するのがベストプラクティスです。UTC では夏時間 (DST) が適用されないため、夏時間の日付となっても時刻を調整する必要はありません。ローカルタイムゾーンを使用する必要がある場合は、代わりにアプリケーションレイヤーでタイムゾーンを変更してください。その際、事前にデータベース管理者またはアプリケーションチームに相談してください。Amazon RDS DB インスタンスのタイムゾーンを変更する方法は[こちら](https://repost.aws/ja/knowledge-center/rds-change-time-zone)を参照してください。
- CloudWatch ダッシュボードのタイムゾーン形式を変更して、ダッシュボードのデータを UTC またはローカルタイムで表示することもできます。ローカルタイムは、コンピュータのオペレーティングシステムで指定されているタイムゾーンです。CloudWatch ダッシュボードのタイムゾーン形式を変更する方法は[こちら](https://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/monitoring/change_dashboard_time_format.html)を参照してください。

### 関連するドキュメント

- [データイベントをログ記録する](https://docs.aws.amazon.com/ja_jp/awscloudtrail/latest/userguide/logging-data-events-with-cloudtrail.html)

### 関連情報

- [CloudTrail を用いて不適切な操作を検出する](https://aws.amazon.com/jp/blogs/news/using-cloudtrail-to-identify-unexpected-behaviors-in-individual-workloads/)

# FISCSEC3: システムへ入力されるデータに対し、不良データの混入や不正からの保護のため、どのような対策を取っていますか？

## FISCSEC3-BP01 アプリケーションレイヤでの入力チェックの他、データに対する処理履歴を収集・管理することにより不良データの混入や不正からデータを保護することが可能です。

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 6、実 65

### 解説

- AWS Config を使用します。AWS Config を有効にして、リソース構成の変更を追跡し、リソース構成に関する質問に回答し、特定の時点または一定期間にわたってコンプライアンスを実証し、トラブルシューティングを行い、セキュリティ分析を実行します。構成変更通知を処理するときは、ワーカーで AWS Lambda または Amazon Simple Queue Service (SQS) を活用して、変更通知やアラートを処理、フィルタリング、統合します。
- Amazon S3 バージョニングを使用します。S3 Versioning を使用すると、オブジェクトの複数のバージョンを 1 つのバケットに保持し、誤って削除または上書きされたオブジェクトを復元できます。例えば、オブジェクトを削除した場合、Amazon S3 はオブジェクトを完全に削除する代わりに削除マーカーを挿入します。これが最新のオブジェクトバージョンになります。これにより、以前のバージョンを復元できます。オブジェクトを上書きすると、バケット内の新しいオブジェクトバージョンになります。いつでも以前のバージョンを復元できます。
- Amazon S3 アクセスログを使用します。サーバーアクセスのログには、バケットに対するリクエストの詳細が記録されます。Amazon S3 アクセスログにより、データの新規作成処理について情報の収集・管理を実現することが可能になります。
- AWS CloudTrail を使用します。AWS のサービスによって実行されたアクションは、CloudTrail にイベントとして記録されます。AWS のサービスに対する処理履歴の収集・管理を実現することが可能になります。

# FISCSEC4: 顧客データを保護し、適正に利用するため、どのようにデータを分類・管理していますか?

## FISCSEC4-BP01 金融サービス機関は、データ分類を使用して、機密データまたは重要なデータを適切なレベルの保護で保護する判断を下します。データがオンプレミスシステムまたはクラウドのどちらで処理や保存されているかに関係なく、データ分類は、組織に対するリスクに基づいて、データの機密性、整合性、可用性に対する適切なコントロールレベルを決定するための開始点です。データを分類し、クラウド環境内で適切なコントロール (暗号化など) を実装するのはお客様の責任です。AWS がインフラストラクチャや提供するサービス内に実装するセキュリティコントロールは、最も機密性の高いデータ要件を満たすために使用できます。

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 69

### 解説

- データ分類に基づいて AWS のサービスにタグを付けます。データ分類フレームワークに基づいて AWS リソースでタグを使用して、データガバナンスプログラムへのコンプライアンスを実装します。効率良く複数のリソースにタグを設定する場合、タグエディターや Cloud Formation によるリソースタグが利用できます。
- 分類に基づいてアクセスを制限します。リソースタグと IAM ポリシーを AWS KMS や CloudHSM とともに使用して、データ分類に基づいて保護を実施する独自のポリシーを定義および実装します。たとえば、非常に重要で機密性の高いデータを含むまたは処理する S3 バケットまたは EC2 インスタンスがある場合は、 それらに DataClassification=CRITICAL タグを付けて、 そこに存在するデータを自動的に、AWS KMS で暗号化します。適切なサービスのみが機密コンテンツにアクセスできるようにするには、キーポリシーを使用してそれらの KMS 暗号化キーへのアクセスレベルを定義します。
- 暗号化における鍵管理の権限分離を実装します。データの暗号化を行う際は、暗号化を行う秘密鍵の管理者とデータを所有するリソースの管理者を分離することでより強固なセキュリティ対策を採用することが可能です。AWS Key Management Service (AWS KMS)でカスタマーマネージドキーを使用することで、キーポリシーによりアクセス許可を定義することが可能になります。 例えば、故意／過失に依らず Amazon S3 内のオブジェクトを不特定多数のインターネットに公開してしまった場合でも、暗号化を行う秘密鍵のキーポリシーでインターネットから秘密鍵へのアクセスが許可されていなければ、インターネットから Amazon S3 内のオブジェクトにはアクセスできません。

### 関連情報

- [AWS リソースタグ付けの準備、方法と有効な AWS サービス](https://aws.amazon.com/jp/blogs/news/tagging_approach_governance/)

# FISCSEC5: どのようにアイデンティティを保護し、システムの不正使用を防ぎますか？

## FISCSEC5-BP01 ユーザーのために強度の高いパスワードポリシーを設定する

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 1、実 26

### 解説

ユーザーが各自のパスワードを変更できるように許可する場合は、強力なパスワードを作成することをユーザーに要求するパスワードポリシーを作成します。
IAM ユーザーのデフォルトのパスワードポリシーでは、次の条件が適用されます。

- パスワードの文字数制限: 8 ～ 128 文字
- 大文字、小文字、数字、! @ # $ % ^ & \* ( ) \_ + - = [ ] { } | ' 記号のうち、最低 3 つの文字タイプの組み合わせ
- AWS アカウント名または E メールアドレスと同じでないこと

必要に応じて、IAM コンソールの [Account Settings (アカウント設定)](https://console.aws.amazon.com/iam/home?#account_settings) ページで、AWS アカウントのカスタムパスワードポリシーを作成できます。AWS のデフォルトのパスワードポリシーからアップグレードして、最小文字数、アルファベット以外の文字が必要かどうか、変更頻度など、パスワードの要件を定義します。詳細については、「[IAM ユーザー用のアカウントパスワードポリシーの設定](https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html)」を参照してください。

## FISCSEC5-BP02 初回サインイン時のパスワード変更を強制する

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 1、実 26

### 解説

ID の使用者のみがパスワードを知っている状態を担保するため、ID を発行後、初回サインイン時にパスワードの変更を強制します。IAM ユーザーに初回サインイン時に新しいパスワードの作成を求めるには、AWS マネジメントコンソールの IAM ユーザー作成ウィザードで、[Require password reset (パスワードのリセットが必要)] を選択します。
安全な IAM ユーザーの作成方法は[こちら](https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/troubleshoot_general.html#troubleshoot_general_securely-create-iam-users)を参照してください。

## FISCSEC5-BP03 システムへの接続元を必要最小限に制限する

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 8

### 解説

- システムへの接続許可を、正当な端末やネットワークを利用して接続する場合のみに与えるよう構成することで、不特定多数の端末からの不正アクセスを防止します。接続元の確認方法としては、認証情報、IP アドレス、クライアント証明書などがあり、これらを組み合わせて利用することでセキュリティを強化できます。
- AWS マネジメントコンソールへの API 呼び出しを特定の IP アドレス範囲に限定するには、 一連のアクセス許可がアタッチされた IAM ロール を作成し、aws:SourceIp 条件キーを使用して IAM ロールを引き受けるアクセス許可を IAM ユーザーに付与します。詳細については[こちら](https://aws.amazon.com/jp/premiumsupport/knowledge-center/iam-restrict-calls-ip-addresses/)を参照してください。
- AWS 外のワークロードやアプリケーションなどから AWS の API 呼び出しが必要な場合は、クライアント証明書を利用した一時認証情報の取得を検討します。詳細は [IAM Roles Anywhere](https://docs.aws.amazon.com/ja_jp/rolesanywhere/latest/userguide/introduction.html) を参照してください。

## FISCSEC5-BP04 アイデンティティと接続を一元管理する

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 26

### 解説

- 複数のシステムやアプリケーションへの接続が必要な場合は ID の一元管理を検討します。これによりユーザーはアプリケーションごとに個別のパスワードを使用する必要がなくなり、強度の低いパスワードの設定やパスワードの使い回しなど、パスワードの漏洩につながるリスクを軽減できます。
- AWS Organizations と統合して AWS IAM Identity Center（旧 AWS SSO) を使用することで、複数の AWS アカウントへのアクセスの管理が可能となります。個々のアカウントにおける追加のセットアップは不要です。ユーザー ID は、AWS IAM Identity Center で直接作成することもできますし、Microsoft アクティブディレクトリや、Okta Universal Directory や Azure AD などの標準ベースの ID プロバイダーから持ってくることもできます。AWS IAM Identity Center は AWS アカウントへのアクセスだけでなく、AWS IAM Identity Center 統合アプリケーション、事前統合された SAML アプリケーション、SAML 2.0 を使用したカスタムアプリケーションへの接続をサポートします。

## FISCSEC5-BP05 多要素認証 (MFA) を設定して AWS リソースを保護する

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 26

### 解説

- スタンドアロンアカウント、管理アカウント、メンバーアカウントを含むすべての AWS アカウント の AWS アカウントのルートユーザー と、IAM ユーザーに対して MFA を有効にできます。
  IAM Identity Center では、デフォルトで多要素認証 (MFA) が有効になっています。
- AWS アカウントのルートユーザー と IAM ユーザー、IAM Identity Center の各ユーザーは、複数の MFA デバイスを登録することができます。複数の MFA デバイスを登録すると、柔軟性をもたせることができ、1 つのデバイスが紛失または損傷した場合にアクセスが中断するリスクを軽減できるようになります。
- MFA デバイスが紛失、盗難、またはアクセス不能になった場合は、残りの MFA デバイスのいずれかを使用して、AWS アカウント での回復手順を実行することなく AWS アカウント にアクセスできます。MFA デバイスが紛失または盗難に遭った場合は、関連付けられている IAM プリンシパルからそのデバイスを切り離してください。
- 複数の MFA を使用すると、地理的に離れた場所にいる従業員やリモートで作業している従業員は、ハードウェアベースの MFA 使用して AWS にアクセスできます。ハードウェアデバイスを 1 台送付したり、1 台のハードウェアデバイスを従業員間で物理的に交換したりする必要はありません。金融機関においては災害対策として 2 拠点以上でのオペレーションを想定するケースもあるため、複数の MFA をそれぞれの拠点に配置することで被災時の運用を速やかに切り替えることが可能です。
- IAM プリンシパルに追加の MFA デバイスを使用すると、1 つ以上の MFA を日常的に使用できると同時に、物理 MFA デバイスをボールドなどの安全な物理的な場所に保存したり、バックアップや冗長性を確保したりできます。

# FISCSEC6: どのようにサービスの不正利用の対策を行いますか？

## FISCSEC6-BP01 顧客への通知を行う

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 112

### 解説

- 決済などの特定取引を行う際には、接続相手先が本人であることを確認する予防策として、SMS など登録情報を利用した追加認証を実施します。また、取引の完了時には、顧客への通知を実装します。Amazon Simple Notification Service (SNS) を用いることで、顧客へ SMS を送信します。不正利用の発見/防止に利用することが可能です。

# FISCSEC7: どのようにセキュリティインシデントの対策を行いますか？

## FISCSEC7-BP01 アクセス履歴と状況を管理する

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 11、実 16、実 113

### 解説

- ブルートフォース攻撃や不正アクセスを検知するために、ログイン試行回数やログイン履歴などのアプリケーションログを収集します。CloudWatch エージェントや Kinesis エージェントを EC2 にインストールすることで、AWS 上で業務アプリケーションのログを収集することができます。コンテナを実行する場合には、Firelens を用いてログを AWS 上に保存することができます。データベースへのアクセス状況を把握するためには、監査ログが利用できます。
- 多要素認証 (MFA) の有無やアクセス元 IP アドレスに応じて、アクセス権を制限します。例えば、本番環境などのリソースにアクセスできる IAM ロールの割り当てには、特定 IP アドレスからのアクセスおよび MFA 利用の要求を設定します。

## FISCSEC7-BP02 アプリケーションを保護する

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 16

### 解説

- 予期されるネットワークトラフィックと予期しないネットワークトラフィックを監視します。不規則なアクセスやネットワークトラフィックを特定します。例えば、ネットワークのメトリクスを監視し、通常時よりも多大なトラフィックが検知される場合は攻撃を受けている可能性があります。予期しない外部システムへの接続の試みは、内部ホストが侵害されている可能性があります。
- VPC フローログで IP トラフィックに関する情報を記録します。CloudTrail を有効化することで、AWS 環境の API アクティビティを記録します。
- AWS Web Application Firewall (WAF) や AWS Shield を用いて外部に公開している Web サイトをサービス妨害攻撃から守ります。AWS WAF では、定義された条件に基づきウェブリクエストを許可、ブロック、監視するルールを設定し、ワークロードを保護します。例えば、レートベースのルールを設定することで、5 分間に一定数以上のリクエストを行った IP アドレスをブロックします。AWS Shield Standard は自動的に有効化され、SYN/UDP フラッド攻撃やリフレクション攻撃といったレイヤー 3 とレイヤー 4 に対する攻撃からワークロードを守ります。AWS Shield Advances を追加で有効化することで、レイヤー 7 に対する DDoS 攻撃を自動的に緩和します。

## FISCSEC7-BP03 アプリケーションの動作を監視する

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 18

### 解説

- 不正利用を検知するために、「アクセス履歴と状況を管理する」の方法で収集したログを分析します。CloudWatch Logs インサイトを用いた分析結果や CloudWatch Logs メトリクスフィルタによって監視されるメトリクスを用いて、CloudWatch Alarm や AWS Lambda のトリガーを行います。ニアリアルタイムの検知を行う場合には、Amazon Kinesis Data Analytics、AWS Lambda、Amazon OpenSearch Service を用いてログを分析します。
- 収集したログの改ざんや削除を防止するため、アクセスを制限します。例えば、ログファイルへのアクセス権限を専用端末にのみ付与し、通常の端末からのアクセスを明示的に拒否します。マルチアカウント戦略を用いる場合には、ログを専用のアカウントに集約します。ログへのアクセスが可能なアカウントを制限します。また、S3 のオブジェクトロック機能を利用することで、専用のアカウントからもログの改ざんや削除ができないように設定します。

# FISCSEC8: 暗号化キーをどのように管理していますか？

## FISCSEC8-BP01 暗号化キーを安全に管理する

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 13、実 30

### 解説

- AWS Key Management Service (AWS KMS) は、カスタマーマスターキー (CMK) によるエンベロープ暗号化戦略を採用しています。エンベロープ暗号化は、平文データをデータキーで暗号化し、次にデータキーを別のキー、即ち CMK で暗号化する方法です。AWS KMS の外部でデータの暗号化に利用するデータキーは、CMK により生成、暗号化、復号されています。CMK は AWS KMS で作成され、暗号化されていない状態のままになることはありません。
- AWS KMS は、カスタマー管理の CMK、AWS 管理の CMK、AWS 所有の CMK という 3 種類の CMK をサポートします。詳細については、[こちら](https://docs.aws.amazon.com/kms/latest/developerguide/concepts.html#master_keys)を参照してください。多くの金融機関のお客様にとって、カスタマー管理の CMK は、お客様のアプリケーションと AWS のサービスの両方からのアクセス権限を管理できるため推奨されます。カスタマー管理の CMK は、キーの生成や保管にさらなる柔軟性も提供します。また、キーの使用またはポリシーの変更はすべて、監査目的で AWS CloudTrail を用いて記録します。

## FISCSEC8-BP02 暗号化キーのローテーションを行う

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 30

### 解説

- 同じ暗号化キーの長期間利用を避け、CMK の自動キーローテーションを有効にします。カスタマー管理の CMK の自動キーローテーションを有効にすると、AWS KMS は CMK の新しいキーマテリアルを毎年生成します。AWS KMS は既存のデータキーで暗号化したデータも復号できるように、既存のキーマテリアルも保存します。
- 自動キーローテーションは、既存のデータキーで暗号化されているデータには影響しません。既存のデータキーを変更することや、既存のデータキーで暗号化されているデータを再び暗号化することはありません。また、既存のデータキーが侵害された場合、自動キーローテーションではその影響を軽減することはできません。新しいデータキーを用いて再び暗号化する必要があります。

## FISCSEC8-BP03 暗号化における鍵管理の権限を分離する

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 30

### 解説

- データの暗号化を行う際は、暗号化を行う秘密鍵の管理者とデータを所有するリソースの管理者を分離することでより強固なセキュリティ対策を採用することが可能です。AWS KMS でカスタマーマネージドキーを使用することで、キーポリシーによりアクセス許可を定義することが可能になります。例えば、故意/過失に依らず Amazon S3 内のオブジェクトを不特定多数のインターネットに公開してしまった場合でも、暗号化を行う秘密鍵のキーポリシーでインターネットから秘密鍵へのアクセスが許可されていなければ、インターネットから Amazon S3 内のオブジェクトにはアクセスできません。

## FISCSEC8-BP04 データの利用終了時に暗号化キーを削除する

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 82

### 解説

- AWS はお客様に重要なデータやトラフィックの暗号化による保護を推奨しており、そのための機能を提供しています。AWS のストレージサービス（Amazon EBS, Amazon S3）ではデフォルトでお客様のデータの暗号化を行う機能を提供しています。また、AWS KMS によりお客様が作成するキー(カスタマーマネージドキー)を用いてデータを暗号化することが可能です。これによりお客様が定義したポリシーでキーへのアクセスを統制しながら、利用状況の証跡を取得することが可能となります。データの利用が終了し、EBS や S3 バケットを削除する際に、あわせて当該領域の暗号化に用いたキーを KMS より削除することで、データの復号を困難にするとともに、廃棄証明の代わりとすることができます。キーへのアクセスが無くなることで、お客様は廃棄されたデータへアクセスができなくなります。なお、削除可能なキーは、カスタマーマネージドキーのみであり、AWS マネージドキー、AWS 所有のキーを削除することはできません。
- データの利用終了時に暗号化キーを削除する際は、同一のキーが他のデータにも利用されていないことを確認する必要があります。利用中のデータが同一のキーで暗号化されている場合、キーの削除によりデータの復号が不可能となります。機密性や重要度の高いデータについては、専用の暗号化キーを作成し、キーの再利用を避けることを推奨します。

# FISCSEC9: マルウェアからどのようにシステムを守りますか？

## FISCSEC9-BP01 コンピューティングリソースを保護して、マルウェアの侵入を防ぐ

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 22、実 32

### 解説

- コンピューティングリソースを保護して、マルウェアのインストールに悪用される可能性のある脆弱性に対してパッチが適用されていることを確認します。コンピューティングリソースに自動的にパッチを適用し、コンプライアンスを監視できるようにします。
- 利用者が定めた基準に準拠しているゴールデンイメージを作成し配布します。基準に準拠しているゴールデンイメージのみ使用を許可します。EC2 Image Builder を使用して、Amazon EC2 で使用する Linux または Windows Server のイメージを作成、保守、検証、共有、デプロイします。 また、ウイルス対策およびエンドポイント保護エージェント、ファイルの整合性、侵入検知エージェントなどの追加の保護ソフトウェアをゴールデンイメージに含みます。
- Amazon Inspector を使用して、脆弱性への準拠について新しい AMI やコンテナイメージをテストします。Amazon Inspector ルールの更新に応じて、既存の AMI やコンテナイメージも定期的に再テストし、新たに見つかった脆弱性の影響から保護します。また、EC2 Image Builder は独自のテストを実行して、機能、互換性、セキュリティコンプライアンスについて AMI を検証することもできます。
- 既知および新たなセキュリティの脆弱性を自動的に修正することもできます。Amazon Inspector サービスを使用して本番環境のサーバーを自動的にスキャンし、セキュリティに関する検出結果を Amazon Simple Notification Service (SNS) トピックに公開できます。次に、これらの通知によってトリガーされる AWS Lambda 関数を作成して検出結果を調べ、問題のタイプに基づいて適切な修復を実装します。
- Systems Manager Session Manager を使用することで、インバウンドポートを開くことなく、安全で監査可能なインスタンス管理が可能となります。

## FISCSEC9-BP02 頻繁なバックアップを取得する

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 22、実 32

### 解説

- 攻撃を受けた場合、バックアップから元のデータを復元する必要があります。定期的にデータのバックアップを取得し、世代管理する事が可能です。頻繁にバックアップし、要件に合わせて保存期間を定めることでコストを限定することも可能です。また、AWS Backup では Vault Lock 機能があり、バックアップデータへの書き込み/編集ができないよう設定が可能です。

# FISCSEC10: どのように電子メールを安全に運用しますか？

## FISCSEC10-BP01 電子メールをなりすましと改ざんから保護する

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 138

### 解説

- SPF、DKIM、DMARC 認証を用いて、電子メールのなりすましや改ざんを検知します。ドメイン認証を最大限保護するためには、SPF 認証と DKIM 認証の両方と連携した DMARC 認証が必要です。Amazon Simple Email Service (SES) における DMARC 認証の具体的な設定手順や詳細な説明は[こちら](https://docs.aws.amazon.com/ses/latest/dg/send-email-authentication-dmarc.html)を参照してください。
- DNSSEC を設定し、ドメインを DNS キャッシュポイズニングなどの攻撃から防御します。詳細は[こちら](https://docs.aws.amazon.com/ja_jp/Route53/latest/DeveloperGuide/domain-configure-dnssec.html)を参照してください。
- メールの受信者が送信元を迅速に判別できるように、BIMI を[こちら](https://docs.aws.amazon.com/ses/latest/dg/send-email-authentication-bimi.html)のように設定できます。ワンタイムパスワードを SMS で送信する際には、専用のショートコードを用いることで、受信者は送信元を判別しやすくなります。Amazon Simple Notification Service (SNS) におけるショートコードの設定手順はこちら[こちら](https://docs.aws.amazon.com/ja_jp/sns/latest/dg/channels-sms-awssupport-short-code.html)を参照してください。

## FISCSEC10-BP02 送信する電子メールデータを保護する

### 対応する FISC 安全対策基準・解説書の実務基準番号

実 138

### 解説

- Amazon SES を用いることで、S/MIME または PGP を使用して、電子メールデータが暗号化されたメッセージを送信することができます。また、電子メールデータのハッシュ値をデジタル署名として元データへと付与できます。詳細は[こちら](https://docs.aws.amazon.com/ja_jp/ses/latest/dg/security-protocols.html)をご参照ください。また、Amazon SES は[スパムやマルウェアを含むメッセージを送信前に検出しブロックします](https://docs.aws.amazon.com/ja_jp/ses/latest/dg/success-metrics.html)。
- ファイルを外部の組織へと共有する前に、マルウェアに感染していないか確認します。Amazon GuardDuty Malware Protection for S3 は Amazon S3 上へと新規にアップロードされたオブジェクトをスキャンし、マルウェアの脅威を検出します。詳細は[こちら](https://docs.aws.amazon.com/ja_jp/guardduty/latest/ug/how-malware-protection-for-s3-gdu-works.html)をご参照ください。
